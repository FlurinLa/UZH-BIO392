```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Step 1: Install package

```{r}
if (!require(devtools)){
    install.packages('devtools')
}
devtools::install_github('progenetix/pgxRpi')
library(pgxRpi)
```

## Step2: Search esophageal adenocarcinoma NCIt 

C4025 

## Step3: Access the CNV frequency data from samples with esophageal adenocarcinoma

```{r}
?pgx
freq <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C4025',
                  codematches=T)
```
'pgxseg' is file format in porgenetix
codematches=T: we only want that specific cancer

### The retreived data is an object contaning two slots `meta` and `data`.

The `meta` slot looks like this:

```{r}
freq$meta
```

The `data` slot includes two matrices.

```{r}
names(freq$data)
```
total matrix: is all the different code matrices concatenated
In this case, these two matrices are the same, since we only have one code

```{r}
head(freq$data$`NCIT:C4025`)
```

```{r}
dim(freq$data$`NCIT:C4025`)
```

## Step4: Visualize data

### By genome

```{r}
pgxFreqplot(freq)
```
middle dash line for each chromo separates p- from q-arm


### By chromosome

```{r}
pgxFreqplot(freq,chrom = 20)
```

## Step5: Analyse the data

According the plot, we can see frequenct gains on chromosome 7p, 8q, 20p,20q 
and frequenct losses on chromosome 4p,4q, 5q, 9p, 17p, 18q, 21q.

There is a literature where the findings are consistent with the majority of mine. Here is the [paper-link](https://www.nature.com/articles/modpathol2008150).

A more detailed use case see this [link](https://htmlpreview.github.io/?https://github.com/progenetix/pgxRpi/blob/main/vignettes/Introduction_2_loadfrequency.html).

```{r}
plot_freq <- function(NCIT_code){
  freq <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C4025',
                  codematches=T)
  pgxFreqplot(freq)
}

codes <- c("NCIT:C3058", "NCIT:C9245", "NCIT:C2926", "NCIT:C4349", "NCIT:C3224")
for (i in codes){
  plot_freq(codes[i])
}
```

Glioblastoma (NCIT:C3058)
Invasive Breast Carcinoma (NCIT:C9245)
Lung Non-Small Cell Carcinoma (NCIT:C2926)
Colon Adenocarcinoma(NCIT:C4349)
Melanoma(NCIT:C3224)
