```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Step 1: Install package

```{r}
if (!require(devtools)){
    install.packages('devtools')
}
devtools::install_github('progenetix/pgxRpi')
library(pgxRpi)
```

## Step2: Search esophageal adenocarcinoma NCIt code

## Step3: Access the CNV frequency data from samples with esophageal adenocarcinoma
# I am doing it now on pancreatic cancer
```{r}
freq <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C3224',
                  codematches=T)
```

### The retreived data is an object contaning two slots `meta` and `data`.

The `meta` slot looks like this:

```{r}
freq$meta
```

The `data` slot includes two matrices.

```{r}
names(freq$data)
```

In this case, these two matrices are the same.

```{r}
head(freq$data$`NCIT:C4025`)
```

```{r}
dim(freq$data$`NCIT:C4025`)
```

## Step4: Visualize data

### By genome

```{r}
pgxFreqplot(freq)
```

### By chromosome

```{r}
pgxFreqplot(freq,chrom = 4)
```

According to the plot, we can see:

Frequency gains: q1, p5, p6, p7, q7, q8, p20, q20, q22
Frequency losses: p4, q4, p9, q9, p10, q10, Y
