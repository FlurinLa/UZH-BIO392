---
title: "2021-10-01-ann-kristin-jochum-day8-progenetix-exercise"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Load libraries

```{r}
library(pgxRpi)
```

## Search for the NCIt code of melanoma and NSCLC

Melanoma: Code C3224
NSCLC: Code C2926
Colorectal cancer: Code C2955

## Get the CNV frequency data

```{R}
freq_melanoma <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C3224',
                  codematches=T)
freq_NSCLC <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C2926',
                  codematches=T)

```


## Check downloaded meta files

```{R}
freq_melanoma$meta
freq_NSCLC$meta

````

## Check downloaded data

```{R}
head(freq_melanoma$data$`NCIT:C3224`)
head(freq_NSCLC$data$`NCIT:C2926`)
````
```{R}
dim(freq_melanoma$data$`NCIT:C3224`)
dim(freq_NSCLC$data$`NCIT:C2926`)

````

## Visualize data (melanoma)

```{R}
pgxFreqplot(freq_melanoma)
````
Frequent gains in chromosome 1, 7, 20 and 22; frequent losses in chromosome 6, 9, 10 and 11

## Take a closer look at chromosomes (melanoma)

```{R}
pgxFreqplot(freq_melanoma,chrom = 1)
pgxFreqplot(freq_melanoma,chrom = 7)
pgxFreqplot(freq_melanoma,chrom = 20)
pgxFreqplot(freq_melanoma,chrom = 22)
pgxFreqplot(freq_melanoma,chrom = 6)
pgxFreqplot(freq_melanoma,chrom = 9)
pgxFreqplot(freq_melanoma,chrom = 10)
pgxFreqplot(freq_melanoma,chrom = 11)
````

Frequent gains on chromosomes 1q, 6p, 7q, 7p, 20q, 20p, 22q
Frequent losses on chromosomes 6q, 9p, 9q, 10p, 10q, 11p, 11q

## Visualize data (NSCLC)

```{R}
pgxFreqplot(freq_NSCLC)
````
Frequent gains in chromosome 1, 3, 5, 7 and 8; frequent losses in chromosome 3, 8, 9 and 13

## Take a closer look at chromosomes (NSCLC)

```{R}
pgxFreqplot(freq_NSCLC,chrom = 1)
pgxFreqplot(freq_NSCLC,chrom = 3)
pgxFreqplot(freq_NSCLC,chrom = 5)
pgxFreqplot(freq_NSCLC,chrom = 7)
pgxFreqplot(freq_NSCLC,chrom = 8)
pgxFreqplot(freq_NSCLC,chrom = 9)
pgxFreqplot(freq_NSCLC,chrom = 13)
````

Frequent gains on chromosomes 1q, 3q, 5p, 7p, 7q and 8q 
Frequent losses on chromosomes 3p, 5q, 8p, 9p, 9q and 13q

## Thoughts on the data
It is interesting to see that when comparing melanoma and NSCLC, melanoma tends to reach higher percentages of gains/losses than NSCLC (caveat: y-axis of the plots!), whith several chromosomes reaching over 50% while NSCLC barely gets one over 40%. Also, while both tumor types have various chromosome arms where CNVs are frequent, melanoma tends to have either gains on both arms OR losses on both arms of the same chromosome, while NSCLC has diverging CNVs with one arm showing gains and the other losses.

Literature:
* Consistent with findings in NSCLC: [Genome-wide copy number variation pattern analysis and a classification signature for non-small cell lung cancer](https://onlinelibrary.wiley.com/doi/10.1002/gcc.22460)



